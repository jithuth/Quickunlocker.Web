@model Quickunlocker.Web.Pages.AdminPanel.Networks.IndexModel

<div class="table-responsive">
    <table class="table table-bordered table-striped table-hover">
        <thead>
            <tr>
                <th style="width:50px">#</th>
                <th>Network Name</th>
                <th style="width:150px">Country</th>
                <th style="width:80px">Logo</th>
                <th style="width:100px">Display Order</th>
                <th style="width:100px">Status</th>
                <th style="width:150px">Actions</th>
            </tr>
        </thead>
        <tbody>
            @if (Model.Networks != null && Model.Networks.Count > 0)
            {
                int serial = Model.SerialStart;
                foreach (var network in Model.Networks)
                {
                    <tr class="@(!network.IsActive ? "table-secondary" : "")">
                        <td>@serial</td>
                        <td>
                            <strong>@network.Name</strong>
                            @if (!network.IsActive)
                            {
                                <span class="badge badge-secondary">Disabled</span>
                            }
                        </td>
                        <td>
                            @if (network.Country != null)
                            {
                                @if (!string.IsNullOrEmpty(network.Country.FlagUrl))
                                {
                                    <img src="@network.Country.FlagUrl" alt="@network.Country.Name" class="img-thumbnail" style="height:20px; width:auto; margin-right:5px;" />
                                }
                                <span>@network.Country.Name</span>
                            }
                        </td>
                        <td class="text-center">
                            @if (!string.IsNullOrEmpty(network.LogoUrl))
                            {
                                <img src="@network.LogoUrl" alt="@network.Name" class="img-thumbnail" style="height:30px; max-width:60px;" />
                            }
                            else
                            {
                                <span class="text-muted">N/A</span>
                            }
                        </td>
                        <td class="text-center">@network.DisplayOrder</td>
                        <td class="text-center">
                            <form method="post" asp-page-handler="ToggleActive" asp-route-id="@network.Id" style="display:inline;">
                                @if (network.IsActive)
                                {
                                    <button type="submit" class="btn btn-success btn-sm" title="Enabled - Click to Disable">
                                        <i class="fas fa-check-circle"></i> Enabled
                                    </button>
                                }
                                else
                                {
                                    <button type="submit" class="btn btn-secondary btn-sm" title="Disabled - Click to Enable">
                                        <i class="fas fa-ban"></i> Disabled
                                    </button>
                                }
                            </form>
                        </td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <a href="/AdminPanel/Networks/Edit/@network.Id" class="btn btn-info" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <button type="button" class="btn btn-danger" title="Delete" 
                                        onclick="confirmDelete('@network.Id', '@Html.Raw(network.Name.Replace("'", "\\'"))', '@Html.Raw(network.Country?.Name?.Replace("'", "\\'") ?? "")')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    serial++;
                }
            }
            else
            {
                <tr>
                    <td colspan="7" class="text-center text-muted py-4">
                        <i class="fas fa-network-wired fa-3x mb-3 d-block"></i>
                        <p class="mb-0">
                            @if (!string.IsNullOrWhiteSpace(Model.Search) || Model.CountryFilter.HasValue)
                            {
                                <span>No networks found matching your criteria.</span>
                            }
                            else
                            {
                                <span>No networks found. <a href="/AdminPanel/Networks/Create">Add your first network</a></span>
                            }
                        </p>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

@if (Model.TotalPages > 1)
{
    <div class="d-flex justify-content-between align-items-center mt-3">
        <div>
            <p class="text-muted mb-0">
                @if (Model.Networks.Count > 0)
                {
                    <span>Showing @Model.SerialStart to @(Model.SerialStart + Model.Networks.Count - 1) of @Model.TotalItems networks</span>
                }
            </p>
        </div>
        <nav>
            <ul class="pagination mb-0" id="pagination">
                @{
                    bool isFirstPage = Model.CurrentPage == 1;
                    bool isLastPage = Model.CurrentPage >= Model.TotalPages;
                }
                
                <li class="page-item @(isFirstPage ? "disabled" : "")">
                    <a class="page-link" href="javascript:void(0)" data-page="@(Model.CurrentPage - 1)">
                        <span>&laquo;</span>
                    </a>
                </li>
                
                @{
                    int startPage = Math.Max(1, Model.CurrentPage - 2);
                    int endPage = Math.Min(Model.TotalPages, Model.CurrentPage + 2);
                    
                    if (startPage > 1)
                    {
                        <li class="page-item">
                            <a class="page-link" href="javascript:void(0)" data-page="1">1</a>
                        </li>
                        if (startPage > 2)
                        {
                            <li class="page-item disabled"><span class="page-link">...</span></li>
                        }
                    }
                    
                    for (var i = startPage; i <= endPage; i++)
                    {
                        <li class="page-item @(Model.CurrentPage == i ? "active" : "")">
                            <a class="page-link" href="javascript:void(0)" data-page="@i">@i</a>
                        </li>
                    }
                    
                    if (endPage < Model.TotalPages)
                    {
                        if (endPage < Model.TotalPages - 1)
                        {
                            <li class="page-item disabled"><span class="page-link">...</span></li>
                        }
                        <li class="page-item">
                            <a class="page-link" href="javascript:void(0)" data-page="@Model.TotalPages">@Model.TotalPages</a>
                        </li>
                    }
                }
                
                <li class="page-item @(isLastPage ? "disabled" : "")">
                    <a class="page-link" href="javascript:void(0)" data-page="@(Model.CurrentPage + 1)">
                        <span>&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
}

@model Quickunlocker.Web.Pages.AdminPanel.Countries.IndexModel

<div class="table-responsive">
    <table class="table table-bordered table-striped table-hover">
        <thead>
            <tr>
                <th style="width:50px">#</th>
                <th style="width:80px">Flag</th>
                <th>Country Name</th>
                <th style="width:80px">Code</th>
                <th style="width:100px">Display Order</th>
                <th style="width:100px">Status</th>
                <th style="width:150px">Actions</th>
            </tr>
        </thead>
        <tbody>
            @if (Model.Countries != null && Model.Countries.Count > 0)
            {
                int serial = Model.SerialStart;
                foreach (var c in Model.Countries)
                {
                    <tr class="@(!c.IsActive ? "table-secondary" : "")">
                        <td>@serial</td>
                        <td class="text-center">
                            @if (!string.IsNullOrEmpty(c.FlagUrl))
                            {
                                <img src="@c.FlagUrl" alt="@c.Name" class="img-thumbnail" style="height:30px; max-width:45px;" />
                            }
                            else
                            {
                                <span class="text-muted">N/A</span>
                            }
                        </td>
                        <td>
                            <strong>@c.Name</strong>
                            @if (!c.IsActive)
                            {
                                <span class="badge badge-secondary">Disabled</span>
                            }
                        </td>
                        <td><code>@c.Code</code></td>
                        <td class="text-center">@c.DisplayOrder</td>
                        <td class="text-center">
                            <form method="post" asp-page-handler="ToggleActive" asp-route-id="@c.Id" style="display:inline;">
                                @if (c.IsActive)
                                {
                                    <button type="submit" class="btn btn-success btn-sm" title="Enabled - Click to Disable">
                                        <i class="fas fa-check-circle"></i> Enabled
                                    </button>
                                }
                                else
                                {
                                    <button type="submit" class="btn btn-secondary btn-sm" title="Disabled - Click to Enable">
                                        <i class="fas fa-ban"></i> Disabled
                                    </button>
                                }
                            </form>
                        </td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <a href="/AdminPanel/Countries/Edit/@c.Id" class="btn btn-info" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <button type="button" class="btn btn-danger" title="Delete" 
                                        onclick="confirmDelete('@c.Id', '@Html.Raw(c.Name.Replace("'", "\\'"))')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    serial++;
                }
            }
            else
            {
                <tr>
                    <td colspan="7" class="text-center text-muted py-4">
                        <i class="fas fa-globe fa-3x mb-3 d-block"></i>
                        <p class="mb-0">
                            @if (!string.IsNullOrWhiteSpace(Model.Search))
                            {
                                <span>No countries found matching "@Model.Search"</span>
                            }
                            else
                            {
                                <span>No countries found. <a href="/AdminPanel/Countries/Create">Add your first country</a></span>
                            }
                        </p>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

@if (Model.TotalPages > 1)
{
    <div class="d-flex justify-content-between align-items-center mt-3">
        <div>
            <p class="text-muted mb-0">
                @if (Model.Countries.Count > 0)
                {
                    <span>Showing @Model.SerialStart to @(Model.SerialStart + Model.Countries.Count - 1) of @Model.TotalItems countries</span>
                }
            </p>
        </div>
        <nav>
            <ul class="pagination mb-0" id="pagination">
                @{
                    bool isFirstPage = Model.CurrentPage == 1;
                    bool isLastPage = Model.CurrentPage >= Model.TotalPages;
                }
                
                <li class="page-item @(isFirstPage ? "disabled" : "")">
                    <a class="page-link" href="javascript:void(0)" data-page="@(Model.CurrentPage - 1)">
                        <span>&laquo;</span>
                    </a>
                </li>
                
                @{
                    int startPage = Math.Max(1, Model.CurrentPage - 2);
                    int endPage = Math.Min(Model.TotalPages, Model.CurrentPage + 2);
                    
                    if (startPage > 1)
                    {
                        <li class="page-item">
                            <a class="page-link" href="javascript:void(0)" data-page="1">1</a>
                        </li>
                        if (startPage > 2)
                        {
                            <li class="page-item disabled"><span class="page-link">...</span></li>
                        }
                    }
                    
                    for (var i = startPage; i <= endPage; i++)
                    {
                        <li class="page-item @(Model.CurrentPage == i ? "active" : "")">
                            <a class="page-link" href="javascript:void(0)" data-page="@i">@i</a>
                        </li>
                    }
                    
                    if (endPage < Model.TotalPages)
                    {
                        if (endPage < Model.TotalPages - 1)
                        {
                            <li class="page-item disabled"><span class="page-link">...</span></li>
                        }
                        <li class="page-item">
                            <a class="page-link" href="javascript:void(0)" data-page="@Model.TotalPages">@Model.TotalPages</a>
                        </li>
                    }
                }
                
                <li class="page-item @(isLastPage ? "disabled" : "")">
                    <a class="page-link" href="javascript:void(0)" data-page="@(Model.CurrentPage + 1)">
                        <span>&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
}
